<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Cascade Studio Gallery</title>
        <!--<heading style="display:none;">Cascade Studio</heading>-->
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
        <meta name="application-name" content="Cascade Studio">
        <meta name="description" content="A Full Live-Scripted CAD Kernel in the Browser">
        <meta name="keywords" content="SCAD, OpenSCAD, CAD, OpenCascade, Scripting">
        <meta name="author" content="Johnathon Selstad">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="theme-color" content="#1e1e1e">

        <!-- Include Tailwind.css -->
        <link href="https://unpkg.com/tailwindcss@^1.0/dist/tailwind.min.css" rel="stylesheet">
        <!-- The core Firebase JS SDK is always required and must be listed first -->
        <script src="https://www.gstatic.com/firebasejs/7.18.0/firebase-app.js"></script>
        <!-- TODO: Add SDKs for Firebase products that you want to use
            https://firebase.google.com/docs/web/setup#available-libraries -->
        <script src="https://www.gstatic.com/firebasejs/7.18.0/firebase-auth.js"></script>
        <script src="https://www.gstatic.com/firebasejs/7.18.0/firebase-firestore.js"></script>
        <script src="https://www.gstatic.com/firebasejs/7.18.0/firebase-storage.js"></script>
        <!-- Include the Firebase Sign-in Auth UI -->
        <script src="https://www.gstatic.com/firebasejs/ui/4.6.1/firebase-ui-auth.js"></script>
        <link type="text/css" rel="stylesheet" href="https://www.gstatic.com/firebasejs/ui/4.6.1/firebase-ui-auth.css" />

        <!-- Inject Headers/Footers, Handle Basic Auth, etc. -->
        <script type="text/javascript" src = "/Gallery/js/main.js"></script>
        
    </head>

    <body style="margin: 0; background: rgb(54, 54, 54); color: white; ">
      <h1 class="m-8 mb-3 text-3xl">Edit Profile</h1>
      <div class="shadow-md rounded px-8 pt-6 pb-8 mb-4 flex flex-col my-2">
        <div class="-mx-3 md:flex mb-6">
          <div class="md:w-1/4 px-3 mb-6 md:mb-0">
            <label for="grid-username" class="block uppercase tracking-wide text-grey-darker text-xs font-bold mb-2">
              Display Name
            </label>
            <input id="grid-username" type="text" placeholder="???" class="appearance-none block w-full text-gray-800 border border-red rounded py-3 px-4 mb-3">
          </div>
          <div class="md:w-1/4 px-3 mb-6 md:mb-0">
            <label for="grid-avatar" class="block uppercase tracking-wide text-grey-darker text-xs font-bold mb-2">
              Avatar URL
            </label>
            <input id="grid-avatar" type="text" placeholder="???" class="appearance-none block w-full text-gray-800 border border-red rounded py-3 px-4 mb-3">
          </div>
        </div>
        <div class="-mx-3 md:flex mb-6">
          <div class="md:w-1/3 px-3">
            <label class="block uppercase tracking-wide text-grey-darker text-xs font-bold mb-2" for="grid-description">
              Description
            </label>
            <textarea id="grid-description" placeholder="A lone soul among the nameless masses" class="appearance-none block w-full h-16 text-gray-800 border border-grey-lighter rounded py-3 px-4 mb-3"> </textarea>
            <p class="text-grey-dark text-xs italic">Use this description to tell visitors about yourself.</p>
          </div>
        </div>
        <div class="-mx-3 md:flex mb-2">
          <button id="save-button" class="inline-block text-sm px-4 py-2 leading-none border rounded text-white border-white hover:border-transparent hover:text-teal-500 hover:bg-white mt-0 ml-4">Save</button>
        </div>
      </div>

      <!-- Pre-populate the above fields with  -->
      <script>
        onLoadUserProfile.push((userProfileData, user)=>{
          // Get the Relevant Fields
          let usernameElem         = document.getElementById("grid-username");
          let descriptionElem      = document.getElementById("grid-description");
          let avatarElem           = document.getElementById("grid-avatar");
          let buttonElem           = document.getElementById("save-button");

          // Populate those fields with the relevant information
          usernameElem.placeholder = userProfileData.username;
          usernameElem      .value = userProfileData.username;
          descriptionElem   .value = userProfileData.summary;
          avatarElem        .value = userProfileData.avatar;

          // Save the modifications to those fields with the values from the database
          buttonElem      .onclick = (event) => {
            console.log(user.uid);
            db.collection("users").doc(user.uid).update({
              username: usernameElem   .value,
              avatar  : avatarElem     .value,
              summary : descriptionElem.value,
            });
          };
        });
      </script>

    </body>
</html>
